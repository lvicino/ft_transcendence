<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interface de Test : API Globale (Auth, OAuth & WS Games)</title>
    <style>
        body { font-family: monospace; background-color: #1e1e1e; color: #d4d4d4; padding: 20px; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px; }
        .panel { border: 1px solid #444; padding: 15px; width: 300px; background-color: #252526; }
        .panel.wide { width: 100%; max-width: 620px; }
        input, textarea { width: 90%; padding: 5px; margin-top: 5px; background: #3c3c3c; border: 1px solid #555; color: #fff; font-family: monospace; }
        button { margin-top: 15px; padding: 8px 15px; cursor: pointer; background: #0e639c; color: white; border: none; }
        button:hover { background: #1177bb; }
        button.action { background: #007acc; margin-top: 5px; }
        button.danger { background: #a31515; }
        .log-panel { border: 1px solid #444; padding: 15px; background-color: #000; margin-bottom: 20px; }
        pre { margin: 0; white-space: pre-wrap; word-wrap: break-word; color: #ce9178; }
        .status { font-weight: bold; color: #4ec9b0; margin-bottom: 10px; display: block; }
        .stream-data { color: #b5cea8; }
    </style>
</head>
<body>
    <h1>Client de Test : Architecture Complète</h1>
    
    <div class="container">
        <div class="panel">
            <h2>POST /api/auth/register</h2>
            <form id="registerForm">
                <label>Email: <input type="email" id="regEmail" required></label><br>
                <label>Username: <input type="text" id="regUsername" required></label><br>
                <label>Password: <input type="password" id="regPassword" required minlength="1"></label><br>
                <button type="submit">Exécuter la requête</button>
            </form>
        </div>

        <div class="panel">
            <h2>POST /api/auth/login</h2>
            <form id="loginForm">
                <label>Email: <input type="email" id="logEmail" required></label><br>
                <label>Password: <input type="password" id="logPassword" required></label><br>
                <button type="submit">Exécuter la requête</button>
            </form>
        </div>

        <div class="panel">
            <h2>GET /api/auth/login/oauth</h2>
            <p style="font-size: 0.9em; color: #888;">Délégation d'authentification (Intranet 42).</p>
            <button id="oauthButton" style="background: #4ec9b0; color: #000; font-weight: bold;">Initialiser OAuth 42</button>
        </div>

        <div class="panel wide">
            <h2>POST /api/games/</h2>
            <p style="font-size: 0.9em; color: #888;">Création d'instance (Requiert cookie valide).</p>
            <form id="gameForm">
                <label>Objet JSON "gameParameter": <br>
                <textarea id="gameParam" rows="5" required>{
  "gw": 100, "gh": 100, "ballRadius": 5,
  "ballSpeed": 5, "playerW": 5, "playerH": 5,
  "playerSpeed": 1, "playerNumber": 2
}</textarea>
                </label><br>
                <button type="submit">Exécuter la requête (Créer la partie)</button>
            </form>
        </div>

        <div class="panel wide">
            <h2>WS /api/games/ws</h2>
            <p style="font-size: 0.9em; color: #888;">Connexion TCP persistante et multiplexage d'entrées.</p>
            <form id="wsForm">
                <label>Game ID: <input type="text" id="wsGameId" required></label><br>
                <label>Password (Optionnel): <input type="text" id="wsPassword"></label><br>
                <button type="submit" id="wsConnectBtn">Ouvrir le tunnel WebSocket</button>
            </form>
            
            <div id="wsControls" style="display: none; margin-top: 15px; border-top: 1px solid #555; padding-top: 10px;">
                <strong>Transmission d'Inputs :</strong><br>
                <button type="button" class="action" onclick="sendWsInput(-1)">Vecteur -1 (Haut/Gauche)</button>
                <button type="button" class="action" onclick="sendWsInput(0)">Vecteur 0 (Stop)</button>
                <button type="button" class="action" onclick="sendWsInput(1)">Vecteur 1 (Bas/Droite)</button>
                <br><br>
                <button type="button" class="danger" onclick="closeWs()">Fermer le tunnel (Code 1000)</button>
            </div>
        </div>
    </div>

    <div class="log-panel">
        <h2>Logs Transactionnels (REST & WS Lifecycle)</h2>
        <span id="httpStatus" class="status">En attente d'exécution...</span>
        <pre id="jsonPayload"></pre>
    </div>

    <div class="log-panel">
        <h2>Flux Télémétrique (WebSocket Engine Tick)</h2>
        <span id="wsTickStatus" class="status" style="color: #569cd6;">Désactivé</span>
        <pre id="wsPayload" class="stream-data"></pre>
    </div>

    <script src="app.js"></script>
</body>
</html>